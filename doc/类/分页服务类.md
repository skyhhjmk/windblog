# 分页服务类 (PaginationService) 文档

## 概述

PaginationService 是一个用于生成网页分页导航的工具类。它提供了一个静态方法 `generatePagination`，可以根据提供的参数生成美观且功能完整的分页
HTML 代码。

该服务支持智能分页显示，当总页数超过设定的最大显示页数时，会自动显示省略号以避免页面上出现过多的页码按钮。

## 类信息

- **类名**: `PaginationService`
- **命名空间**: `app\service`
- **位置**: `app/service/PaginationService.php`

## 方法

### generatePagination()

生成分页 HTML 代码。

#### 语法

```php
public static function generatePagination(
    int $currentPage,
    int $totalItems,
    int $itemsPerPage,
    string $routeName,
    array $routeParams = [],
    int $maxDisplayPages = 10
): string
```

#### 参数

| 参数名                | 类型     | 默认值 | 描述            |
|--------------------|--------|-----|---------------|
| `$currentPage`     | int    | 无   | 当前页码          |
| `$totalItems`      | int    | 无   | 总条目数          |
| `$itemsPerPage`    | int    | 无   | 每页显示的条目数      |
| `$routeName`       | string | 无   | 路由名称，用于生成分页链接 |
| `$routeParams`     | array  | []  | 路由参数          |
| `$maxDisplayPages` | int    | 10  | 最大显示页码数       |

#### 返回值

返回生成的分页 HTML 代码字符串。

#### 示例

```php
use app\service\PaginationService;

// 基本用法
$paginationHtml = PaginationService::generatePagination(
    $currentPage,      // 当前页码，如: 3
    $totalItems,       // 总条目数，如: 150
    $itemsPerPage,     // 每页条目数，如: 15
    'posts.index',     // 路由名称
    [],                // 路由参数
    10                 // 最大显示页码数
);

// 带路由参数的用法
$paginationHtml = PaginationService::generatePagination(
    $currentPage,                     // 当前页码
    $totalItems,                      // 总条目数
    $itemsPerPage,                    // 每页条目数
    'posts.category',                 // 路由名称
    ['category_id' => $categoryId],   // 路由参数
    10                                // 最大显示页码数
);
```

## 功能特性

### 1. 智能分页显示

当总页数超过最大显示页数时，分页服务会智能显示页码：

- 始终显示第一页和最后一页
- 在当前页码两侧显示指定数量的页码
- 在适当位置显示省略号以节省空间

例如，如果有 20 页，当前在第 10 页，最大显示页数为 10，则显示：

```
1 ... 8 9 [10] 11 12 ... 20
```

### 2. 完整的导航控件

分页组件包含以下导航元素：

- 上一页按钮
- 下一页按钮
- 页码按钮
- 手动跳转输入框和按钮

### 3. 响应式设计

分页组件使用 Tailwind CSS 类构建，具有良好的响应式特性，可以在不同设备上正常显示。

### 4. 无障碍支持

分页组件包含适当的无障碍支持，如 `sr-only` 类用于屏幕阅读器。

## 使用场景

### 在控制器中使用

```php
// app/controller/PostsController.php
namespace app\controller;

use support\Request;
use app\model\Post;
use app\service\PaginationService;

class PostsController
{
    public function index(Request $request, int $page = 1)
    {
        $totalItems = Post::count();
        $itemsPerPage = 15;
        
        $posts = Post::orderByDesc('created_at')
                    ->forPage($page, $itemsPerPage)
                    ->get();
        
        $paginationHtml = PaginationService::generatePagination(
            $page,
            $totalItems,
            $itemsPerPage,
            'posts.index'
        );
        
        return view('posts/index', [
            'posts' => $posts,
            'pagination' => $paginationHtml
        ]);
    }
}
```

### 在模板中使用

在控制器中生成分页 HTML 后，可以在模板中直接输出：

```twig
{# resources/views/posts/index.html.twig #}
<div class="posts-list">
    {% for post in posts %}
        <!-- 文章内容 -->
    {% endfor %}
</div>

<!-- 输出分页 HTML -->
{{ pagination|raw }}
```

## 自定义样式

分页组件使用 Tailwind CSS 工具类构建。如果需要自定义样式，可以通过以下方式：

1. 修改 Tailwind CSS 配置文件
2. 添加自定义 CSS 类
3. 覆盖现有的 Tailwind 类样式

## 注意事项

1. 确保在使用前已经正确配置了路由系统
2. 当总条目数小于或等于每页条目数时，方法会返回空字符串
3. 路由名称必须在路由配置中正确定义
4. 手动跳转功能需要配合前端 JavaScript 实现

## JavaScript 支持

分页组件包含一个手动跳转功能，需要配合以下 JavaScript 代码使用：

```javascript
function jumpToPage(maxPage) {
    const pageInput = document.getElementById('page-input');
    const page = parseInt(pageInput.value);

    if (isNaN(page) || page < 1 || page > maxPage) {
        alert('请输入有效的页码');
        return;
    }

    // 这里需要根据实际路由生成跳转链接
    window.location.href = `/posts?page=${page}`;
}
```

## 版本历史

- v1.0.0 - 初始版本

## 依赖

- PHP 8.0+
- Tailwind CSS
- Webman 框架的路由系统