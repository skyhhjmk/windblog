<title>{{ page_title|default('搜索') }}</title>
<div id="pjax-container">
<!-- PJAX 隐藏侧栏片段：完成后注入到布局右侧栏 -->
<div id="pjax-sidebar-html" style="display:none">
    {% if sidebar is defined and sidebar.widgets is defined %}
        {% for widget in sidebar.widgets %}
            {% if widget.enabled and widget.html is defined %}
                {{ widget.html|raw }}
            {% endif %}
        {% endfor %}
    {% endif %}
</div>
<div class="max-w-full mx-auto px-4">
    <!-- 搜索标题区域 -->
    <div class="text-center mb-12 animate-fade-in-down">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
            <i class="fas fa-search text-blue-600 mr-3"></i>
            搜索结果
        </h1>
        {% if search_keyword %}
            <p class="text-gray-600 text-lg md:text-xl">
                搜索关键词: <span class="font-semibold text-blue-600">"{{ search_keyword }}"</span>
            </p>
            {% if esMeta is defined and esMeta.signals is defined %}
                <p class="text-sm text-blue-600 mt-2">
                    {% if esMeta.signals.synonym %}已应用同义词扩展匹配{% endif %}
                    {% if esMeta.signals.highlighted %}{% if esMeta.signals.synonym %}、{% endif %}已为关键词提供高亮{% endif %}
                    {% if esMeta.signals.analyzer %}{% if esMeta.signals.synonym or esMeta.signals.highlighted %}、{% endif %}使用分词器: {{ esMeta.signals.analyzer }}{% endif %}
                </p>
            {% endif %}
            <div class="mt-4">
                <div class="inline-flex items-center bg-blue-50 border border-blue-100 text-blue-700 rounded-xl px-4 py-2">
                    <i class="fas fa-list-ol mr-2"></i>
                    共 {{ totalCount|default(0) }} 条结果
                </div>
            </div>
            {% if suggest_titles is defined and suggest_titles|length > 0 %}
                <div class="mt-4 text-left bg-gray-50 border border-gray-100 rounded-2xl p-4">
                    <div class="text-gray-700 font-medium mb-2">猜你想搜</div>
                    <div class="flex flex-wrap gap-2">
                        {% for t in suggest_titles %}
                            <a href="/search?q={{ t|url_encode }}" class="px-3 py-1 bg-white hover:bg-blue-50 text-gray-700 hover:text-blue-700 border border-gray-200 rounded-full text-sm transition-colors">{{ t }}</a>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
        {% endif %}
    </div>

    <!-- 博客文章列表 -->
    {% if posts|length > 0 %}
        <div class="space-y-8">
            {% for post in posts %}
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 group">
                    <div class="p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2 group-hover:text-blue-600 transition-colors duration-200">
                            <a href="/post/{{ post.slug }}.html" target="_blank"
                               class="block">
                                {{ (esMeta.highlights[post.id].title[0] ?? post.title)|raw }}
                            </a>
                        </h2>
                        <div class="flex items-center text-gray-500 text-sm mb-4">
                            <span class="inline-flex items-center px-2 py-0.5 rounded-full border bg-green-50 text-green-700 border-green-100 mr-3 text-xs">
                                文章
                            </span>
                            <span class="mr-4">
                                <i class="far fa-calendar-alt mr-1"></i>
                                {{ post.created_at|date('Y-m-d') }}
                            </span>
                            <span>
                                <i class="far fa-user mr-1"></i>
                                {{ post.author.name }}
                            </span>
                        </div>
                        <p class="text-gray-600 mb-4 leading-relaxed">
                            {{ (esMeta.highlights[post.id].content[0] ?? (post.excerpt ~ '...'))|raw }}
                        </p>
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                            <div class="flex flex-wrap gap-2">
                                {% if post.categories is defined and post.categories|length > 0 %}
                                    {% for c in post.categories %}
                                        <a href="/c/{{ c.slug }}" class="px-2 py-1 text-xs rounded-full bg-blue-50 text-blue-700 border border-blue-100 hover:bg-blue-100 transition-colors">
                                            <i class="fas fa-folder-open mr-1"></i>{{ c.name }}
                                        </a>
                                    {% endfor %}
                                {% endif %}
                                {% if post.tags is defined and post.tags|length > 0 %}
                                    {% for t in post.tags %}
                                        <a href="/t/{{ t.slug }}" class="px-2 py-1 text-xs rounded-full bg-purple-50 text-purple-700 border border-purple-100 hover:bg-purple-100 transition-colors">
                                            <i class="fas fa-hashtag mr-1"></i>{{ t.name }}
                                        </a>
                                    {% endfor %}
                                {% endif %}
                            </div>
                            <a href="/post/{{ post.slug }}.html"
                               class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium transition-colors duration-200">
                                阅读更多
                                <svg class="w-4 h-4 ml-1 transition-transform duration-200 group-hover:translate-x-1" 
                                     fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M9 5l7 7-7 7"></path>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <!-- 分页 -->
        <div class="mt-12 flex justify-center">
            {{ pagination|raw }}
        </div>
    {% else %}
        <div class="bg白 rounded-2xl shadow-lg p-12 text-center animate-fade-in">
            <div class="text-gray-400 mb-4">
                <svg class="w-24 h-24 mx-auto opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
            </div>
            <h3 class="text-2xl font-medium text-gray-700 mb-2">没有找到相关文章</h3>
            <p class="text-gray-500 max-w-md mx-auto">
                {% if search_keyword %}
                    没有找到与 "<span class="font-semibold">{{ search_keyword }}</span>" 相关的文章
                {% else %}
                    请输入搜索关键词
                {% endif %}
            </p>
            <div class="mt-6">
                <a href="/" class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium transition-colors duration-200">
                    <i class="fas fa-home mr-2"></i>
                    返回首页
                </a>
            </div>
        </div>
    {% endif %}
</div>

<style>
    @keyframes fade-in-down {
        0% { opacity: 0; transform: translateY(-20px); }
        100% { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in-down { animation: fade-in-down 0.6s ease-out forwards; }
    @keyframes fade-in { 0% { opacity: 0; } 100% { opacity: 1; } }
    .animate-fade-in { animation: fade-in 0.6s ease-out forwards; }
    .hl { background-color: #ffea7a; color: #7c2d12; padding: 0 2px; border-radius: 2px; font-weight: 700; }
</style>

<script>


</script>
<script>
    (function () {
        function injectSidebar() {
            var t = document.getElementById('pjax-sidebar-html');
            var c = document.getElementById('sidebar-container');
            if (t && c) {
                c.innerHTML = t.innerHTML || '';
            }
        }
        injectSidebar();
        document.addEventListener('page:ready', injectSidebar);
    })();
</script>
</div>